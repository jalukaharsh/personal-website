---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import BlogPostCard from '../components/BlogPostCard.astro';

const booksEntries = await getCollection('books');
const projectsEntries = await getCollection('projects');
const travelEntries = await getCollection('travel');

const allPosts = [...booksEntries, ...projectsEntries, ...travelEntries];

const publishedPosts = allPosts
  .filter(post => !post.data.draft)
  .sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime());

const recentPosts = publishedPosts.slice(0, 5);
---

<BaseLayout 
  title="Harsh Jaluka - Home" 
  description="Welcome to my personal website where I share books, projects, and travel experiences."
>
  <Header slot="header" />
  
  <div class="main-container">
    <section class="section">
      <p class="intro-paragraph">
        Hi, I'm Harsh. This is my corner of the internet where I share thoughts on books I've read, projects I've worked on and places I've traveled to.
      </p>
      
      <p class="intro-paragraph">
        Whether you're here for book recommendations, technical insights, or travel stories, I hope you find something that resonates. This site is a living collection of experiences and ideas that continue to shape how I see the world.
      </p>
      
      <p class="intro-paragraph">
        Feel free to explore the different sections and reach out if something sparks a conversation. 
        I'm always interested in connecting with people who share similar curiosities!
      </p>

      <p class="intro-paragraph">
        The best way to contact me is through email. I'm also available on <a href="https://github.com/jalukaharsh" target="_blank" rel="noopener noreferrer"> Github</a>, <a href="https://www.goodreads.com/user/show/94888357-harsh" target="_blank" rel="noopener noreferrer">Goodreads</a> and 
        (unfortunately) <a href="https://www.linkedin.com/in/harshjaluka/" target="_blank" rel="noopener noreferrer">LinkedIn</a>.
      </p>

    </section>

    <section class="section">
      <h2 class="section-title">Recent Updates</h2>

      {recentPosts.length > 0 ? (
        <div class="posts-list">
          {recentPosts.map(post => {
            const collection = post.collection;
            return (
              <BlogPostCard
                title={post.data.title}
                pubDate={post.data.pubDate}
                slug={post.slug}
                tags={post.data.tags}
                collection={collection}
              />
            );
          })}
        </div>
      ) : (
        <div class="empty-state">
          <p class="empty-message">No posts yet. Check back soon!</p>
        </div>
      )}
    </section>
  </div>

  <Footer slot="footer" />
</BaseLayout>

<style>
  
  .intro-paragraph {
    color: var(--color-text-on-dark);
    font-size: var(--font-size-lg);
    line-height: var(--line-height-relaxed);
    margin-bottom: var(--spacing-6);
  }

  .intro-paragraph a {
    color: var(--color-interactive);
    text-decoration: none;
    transition: var(--transition-colors);
  }

  .intro-paragraph a:hover {
    color: var(--color-interactive);
    text-decoration: underline;
  }

  .section-title {
    font-size: var(--font-size-3xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-text-on-dark);
    margin-bottom: var(--spacing-8);
  }

  .posts-list {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-4);
  }

  .empty-state {
    text-align: center;
    padding: var(--spacing-12) 0;
    background-color: var(--color-bg-content);
    border-radius: var(--radius-lg);
  }

</style>
